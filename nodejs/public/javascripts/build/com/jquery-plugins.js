/**
 ** 
 ** www.huize.com; 
 ** Version:0.1.0;
 ** Last Updated:2016-08-09; 
 **
 **/
define(["jquery"],function($){$.fn.myForm=function(a){var b=$.fn.extend({checkedClass:"hz-check-item-checked",checked:function(){}},a);return this.each(function(){function a(){var a;"checkbox"===d?$(this).toggleClass(b.checkedClass):"radio"===d&&($(this).addClass(b.checkedClass),e&&$('[for="'+e+'"]').removeClass(b.checkedClass)),a=!!$(this).hasClass(b.checkedClass),b.checked.call(c,a,d)}var c=$(this),d=c.attr("rel")||"",e=c.attr("for")||"";d=d.toLowerCase(),d=$.trim(d),e=$.trim(e),c.data("lock")||(c.data("lock",!0),c.on("click",a),c.on("checked",a),c.on("change",a))})},$.fn.dropDown=function(a){var b=$.fn.extend({eventType:"click",type:0,width:"",time:100,height:"",listWidth:"auto",top:function(){return 0},event:function(){},enter:function(){},leave:function(){},select:function(){}},a);return $dropDownSelectArea=$("#dropDownSelectArea"),$("#dropDownSelectArea").length||($("body").append('<div id="dropDownSelectArea"></div>'),$dropDownSelectArea=$("#dropDownSelectArea")),this.each(function(){var a,c=this,d=$(this),e=(d.attr("rel"),d.data("dropdown")),f=(b.height||d.data("height"),b.zIndex||d.data("zindex")),g=d.data("show"),h={width:d.outerWidth(),height:d.outerHeight()},i=$('[data-dropdown-item="'+e+'"]'),j=function(c){a=setTimeout(function(){var a=$('[data-dropdown-item="'+e+'"]:visible');a.hide(),b.leave(d,a),$dropDownSelectArea.html(""),a.length||(a.hide(),$(document).data("lock-dropdown",""),$(document).off("click",j))},c===!0?1:b.time)},k=function(){pos=d.offset(),i.css({position:"absolute",height:b.height,"overflow-y":"auto","z-index":f}),b.width&&i.css({width:b.width}),b.type||i.css({left:pos.left,top:pos.top+h.height,"z-index":f})};$(this).data("lock")||($(this).data("lock",!0),$("[data-dropdown-item]").hide().on("click"),d.on("mouseleave",function(){"mouseenter"===b.eventType&&(clearTimeout(a),j())}).on(b.eventType,function(a){var c="function"==typeof b.top?b.top():b.top;if(!d.hasClass("disabled")){var f=$('[data-dropdown-item="'+e+'"]');if($(".hz-dropdown").css("zIndex",1e3),"none"===f.css("display")&&f.parent().css("zIndex",1001),k(),b.enter(d,i),$("[data-dropdown-item]").each(function(a,b){$(this).attr("data-dropdown-item")!==e&&$(this).hide()}),"body"===g){var h=d.offset();$dropDownSelectArea.html(i.clone(!0)),$dropDownSelectArea.css({position:"absolute",left:h.left,top:h.top+c+d.height()}),$dropDownSelectArea.children().show()}else $('[data-dropdown-item="'+e+'"]').toggle();$(document).data("lock-dropdown")||($(document).data("lock-dropdown",!0),$(document).on("click",function(a){b.event(a)&&j()}))}}),i.on("mouseenter",function(){clearTimeout(a)}).on("mouseleave",function(){"mouseenter"===b.eventType&&j()}).on("click",function(a){b.select.call(c,a)===!0?j(!0):a.stopPropagation()}),$(this).attr("isDropDown",!0),$dropDownSelectArea.css({width:d.data("width")||b.listWidth}))})},$.fn.enterOnlyNumber=function(a){var b=($.fn.extend({},a),function(a){var b=$(this),c=a.which,d=(b.data("max"),b.data("min"),[8,9,27,37,38,39,40,13]),e=c>=96&&105>=c,f=c>=48&&57>=c;return $.inArray(c,d)<0&&!e&&!f?void a.preventDefault():void 0});return this.each(function(){$(this).data("lock")||($(this).data("lock",!0),$(this).keydown(function(a){b(a)}))})},$.fn.eidtNumber=function(a){var b=$.fn.extend({callback:function(){}},a);return this.each(function(){var a=this,c=$(this),d=c.find("span").eq(1),e=c.find("input"),f=c.find("span").eq(0),g=c.data("min")||0,h=c.data("max")||1/0,i=c.data("default")||"",j=c.data("lock"),k=e.val(),l=function(){var a=e.val();g>=a?f.addClass("disabled"):f.removeClass("disabled"),a>=h?d.addClass("disabled"):d.removeClass("disabled")};if(!j){c.on("reset",l),c.trigger("reset"),c.data("lock",!0),$.isNumeric(i)&&e.val(i),k&&(k>h||g>k)&&e.val(""),d.on("click",function(){var d="",f=e.val();k=e.val(),$(this).hasClass("disabled")||(k++,h&&h>=k&&e.val(k),c.trigger("reset"),d=e.val(),b.callback.call(a,f,d,e))}),f.on("click",function(){var d="",f=e.val();k=e.val(),$(this).hasClass("disabled")||(k--,k>=g&&e.val(k),c.trigger("reset"),d=e.val(),b.callback.call(a,f,d,e))}),e.blur(function(){var d=$(this).val();d&&(g>d&&$(this).val(g),d>h&&$(this).val(h)),c.trigger("reset"),b.callback.call(a,d,e.val(),e)});try{e.enterOnlyNumber()}catch(m){}}})},$.fn.selectBox=function(a){function b(a){var b,c=this;c.data("selected",!0).addClass(d.selectedClass),1===d.model?(c.data("selected",!1).siblings(".com-selectbox-item").removeClass(d.selectedClass),a.text?e.data("selectData",{value:a.value,text:a.text}):e.data("selectData",a.value)):(b=e.data("selectData")||[],a.text?b[b.length]={value:a.value,text:a.text}:b[b.length]=a.value,e.data("selectData",b))}var c={data:[],model:1,cls:"",itemCls:"hz-radio-item inline-block",imgCls:"",iconCls:"",textCls:"",selectedClass:"hz-radio-item-checked",defaultSelected:0,onSelect:function(){}},d=$.extend({},c,a);if(0===d.data.length||0===$(this).length)return null;var e=$(this).addClass(d.cls+" "+(1===d.model?"com-radio-list":"com-checkbox-list"));return e.each(function(){var a=$(document.createDocumentFragment()),c="";$.each(d.data,function(e,f){f.value=f.value||e,c=$("<div class='com-selectbox-item'></div>").addClass(d.itemCls).attr("data-value",f.vaule).append(function(){var a="";return a+="<i class='"+d.iconCls+"'></i>",f.img&&(a+="<img class='"+d.imgCls+"' src='"+f.img+"' width='"+d.imgWidth+"' height='"+d.imgHeight+"' alt='"+(f.alt||"")+"'>"),f.text&&(a+="<span class='"+d.textCls+"'> "+f.text+" </span>"),a}).bind("click",function(){b.call($(this),f),d.onSelect.call($(this),$(this))}).appendTo(a)}),a.appendTo(e),$.each(d.data,function(a,c){return c.value===d.defaultSelected||void 0===c.value&&a===d.defaultSelected?(c.value=c.value||d.defaultSelected,void b.call(e.find(".com-selectbox-item").eq(d.defaultSelected),c)):void 0})}),e.item=function(a,b){return b.call(e.find(".com-selectbox-item").eq(a||-1)),e},e.getData=function(){return $(this).data("selectData")},e},$.fn.autoComplete=function(a){function b(a,b){for(var c in a)if(a[c].text===b)return a[c]}function c(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)};c&&!d&&a.apply(e,f),clearTimeout(d),d=setTimeout(g,b)}}function d(a){var c=i.find(g.input);i.find(".com-autoComplete-box").remove();var d=$("<div class='com-autoComplete-box'></div>").css({position:"absolute",border:"1px solid #eee",marginTop:"-1px",borderTop:"none",backgroundColor:"#fff",width:parseInt(c.width())+2*parseInt(c.css("padding-left"))+"px"});""!==a&&($.each(g.data,function(e){g.data[e].text.indexOf(a)>-1&&$("<div class='autoComplete-matched-item'></div>").css({padding:"6px 5px",cursor:"pointer"}).attr("data-value",g.data[e].value).bind("mouseover",function(){$(this).css("background-color","#efefef").addClass("complete-item-current")}).bind("mouseleave",function(){$(this).css("background-color","#fff").removeClass("complete-item-current")}).bind("click",function(){var a=$(this).text();d.remove(),g.onSelect.call($(this),b(g.data,a)),i.data("autoCompleteData",b(g.data,a)),c.val(g.data[e].text)}).append($("<p></p>").text(g.data[e].text)).appendTo(d)}),d.appendTo(i))}function e(a){var b,c=38===a,d=i.find(".autoComplete-matched-item"),e=i.find(".complete-item-current");0!==d.length&&(c?(e.removeClass("complete-item-current").data("select",!1),0===e.index()?(b=d.length-1,d.eq(b).addClass("complete-item-current").data("select",!0)):(b=0===e.length?1:e.index(),d.eq(b-1).addClass("complete-item-current").data("select",!0))):(e.removeClass("complete-item-current").data("select",!1),e.index()===d.length-1?(b=0,d.eq(b).addClass("complete-item-current").data("select",!0)):(b=0===e.length?-1:e.index(),d.eq(b+1).addClass("complete-item-current").data("select",!0))),i.data("autoCompleteData",g.data[b]))}function f(a,c){var d=i.data("autoCompleteData");if(0===i.find(".complete-item-current").length)i.find(".com-autoComplete-box").length>0&&(d={}),c.call(a,d);else{var e=i.find(".complete-item-current").text();i.find(g.input).val(i.find(".complete-item-current").text()),i.data("autoCompleteData",b(g.data,e)),i.find(".com-autoComplete-box").remove()}}var g,h={data:[],input:"",submit:"",onSelect:function(){},onSubmit:function(a){}},i=$(this);return g=$.extend({},h,a),0===g.data.length||0===$(this).length||0===$(this).find(g.input).length?this:i.each(function(){$(this).find(g.input).bind("keyup",function(a){var b=$(this);value=b.val(),c(function(){return 38===a.keyCode||40===a.keyCode?void e(a.keyCode):13===a.keyCode?void f(b,g.onSubmit):void d(value)},10)()}),$(this).find(g.submit).bind("click",function(){f($(this),g.onSubmit)})})},$.extend($.fn,{verify:function(a){function b(a,b){var c,e,f=d.actions,g=a.data("errorMessage")||{};c=void 0===$(this).attr("class")?"":h(($(this).attr("class").match(/{[-_a-zA-Z\d"',:]+\}/)||[])[0]||"{}")(),e=f[$(this).attr("name")||$(this).children("input[type='radio'],input[type='checkbox']").attr("name")],b?($(this).data("valid",!0),c.success&&!$(this).hasClass(c.success)&&$(this).addClass(c.success),!$.isEmptyObject(e)&&$.isFunction(e.success)&&e.success.call($(this)),delete g[$(this).attr("name")]):($(this).data("valid",!1),void 0!==$(this).attr("name")&&(g[$(this).attr("name")]=$(this).attr("msg")||""),c.success&&!$(this).hasClass(c.failed)&&$(this).addClass(c.failed),!$.isEmptyObject(e)&&$.isFunction(e.failed)&&e.failed.call($(this))),a.data("errorMessage",g)}function c(a){var c=$(this),d=c.attr("verify"),e=(c.attr("type"),$.trim(c.val()||"")),g=c.attr("maxLength"),h=c.attr("minLength");/^\/(\n|.)+\/$/.test(d)&&(f[d]=new RegExp(d.substr(1,d.length-2))),void 0!==f[d]&&b.call($(this),a,f[d].test(e)&&(void 0!==h?h<=(c.val()||"").length:!0)&&(void 0!==g?g>=(c.val()||"").length:!0))}var d,e={submit:"input[type='submit']",onSubmit:function(){},actions:{},blurTrigger:!0,errorAction:""};d=$.extend({},e,a);var f={required:/^[^\r\n]+$/,number:/[^\d]/g,email:/^([a-zA-z\d]+)@([a-zA-z\d]+)\.(([a-zA-z\d]+))]$/,phone:/^0\d{2,4}-?\d{7,8}]$/,tel:/^(\+86)?(\d{8}|\d{11})$/},g=$(this),h=function(a){return new Function("return "+a+";")};return g.data("valid",!0),g.each(function(a){var e=$(this),f=e.find("[verify]");e.find(d.submit).bind("click",function(){var a={},f={};e.find("input[verify],select[verify],textarea[verify]").each(function(){var d=$(this)[0].tagName.toLowerCase(),g=$(this).attr("type")||$(this).find("input").attr("type");"text"===g||"password"===g||"email"===g||"textarea"===d?c.call($(this),e):"input"!==d&&"input"!==d&&"radio"===g?(e.find("input[type='radio']").each(function(){a[$(this).attr("name")]=!1}),e.find("input[type = 'radio']").each(function(){void 0!==$(this).attr("checked")&&"false"!==$(this).attr("checked")&&(a[$(this).attr("name")]=!0)}),$.each(a,function(a,c){var d=$("input[name='"+a+"']");b.call(d.parent(),e,c)})):"input"!==d&&"input"!==d&&"checkbox"===g?(e.find("input[type = 'checkbox']").each(function(){f[$(this).attr("name")]=0}),e.find("input[type = 'checkbox']").each(function(){void 0!==$(this).attr("checked")&&"false"!==$(this).attr("checked")&&f[$(this).attr("name")]++}),$.each(f,function(a,c){var d=$("input[name='"+a+"']"),f=d.parent().attr("minLength"),g=d.parent().attr("maxLength");b.call(d.parent(),e,c>0&&(void 0!==f?f>c:!0)&&(void 0!==g?g>c:!0))})):"select"===d&&b.call($(this),e,"请选择"!==$(this).find("option:selected").val())}),e.data("valid",$.isEmptyObject(e.data("errorMessage"))),d.onSubmit.call(e)}),f.each(function(){var a=$(this)[0].tagName.toLowerCase(),b=$(this).attr("type");("input"!==a||"text"!==b&&"password"!==b&&"email"!==b)&&"textarea"!==a||d.blurTrigger&&$(this).blur(function(){c.call($(this),e),"function"==typeof d.errorAction&&d.errorAction.call($(this),e)})})})},valid:function(){return $(this)[0]?$(this).data("valid"):void 0},getError:function(){return $(this)[0]?$(this).data("errorMessage")||{}:void 0}})});