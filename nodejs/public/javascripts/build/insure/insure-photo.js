/**
 ** 
 ** www.huize.com; 
 ** Version:0.1.0;
 ** Last Updated:2016-08-09; 
 **
 **/
define(["webuploader"],function(a){"use strict";var b=function(){},c=['<dd id="uploadImg" class="fn-hide  mb10"><label class="label-item">证件照片</label><div class="inline-block  file-upload-item"><div class="inline-block clearfix" id="thumbPhoto"><div class="fl pic-placeholder p5 bgfb mr10"><img src="//img.huizecdn.com/hz/www/page/default-credentials-pic.png" defaultImg width="150" height="150px"></div></div>','<div class="inline-block f12">','<p class="fc6 mb5">请上传投保人证件，要求可以看清证件号码；</p>','<p class="fc6 mb5">限JPG、JPEG、PNG格式，<br>单张图片大小不得大于5M</p>','<input type="hidden" data-moduleid="10" name="idCardFileIDList" value=""/>','<div id="uploadBtn"><a class="hz-button hz-button-small hz-button-action" href="javascript:;">上传</a></div>',"</div>","</div>","</dd>"];return b.prototype={eventBindBtn:function(b){var c,d=this;c=new a.Uploader({auto:!0,swf:d.uploadSWFUrl,server:d.uploadUrl,accept:{title:"filetype",extensions:"gif,jpg,jpeg,png"},fileSingleSizeLimit:d.SIZE_UPLOAD_IMAGE*d.SIZE_FILE}),c.addButton({id:"#uploadBtn"}),c.on("fileQueued",function(a){d.message.show(d.TEXT_UPLOAD_IMG_UPLOADING,"loading"),c.upload(a.id)}),c.on("error",function(a,b){var c="";switch(d.info(a,b),a){case"F_EXCEED_SIZE":c=d.TEXT_UPLOAD_MAX_SIZE_FN();break;case"Q_TYPE_DENIED":c=d.TEXT_UPLOAD_FORMAT_ERROR}d.message.show(c,"warning",d.messageTimeOut)}),c.on("uploadSuccess",function(a,e){b&&b(e),c.reset(),d.message.hide()})},showUploadImg:function(a){var b=this;a?$("#uploadImg").hasClass("fn-hide")&&($("#uploadImg").removeClass("fn-hide"),b.eventBindBtn(function(a){b.photoUploadCallBack(a)})):$("#uploadImg").addClass("fn-hide")},setIDCardUploadStatus:function(){var a=this,b=$.trim(a.$idCardFileIDList.val())||"",c=$("#uploadBtn");b.split(",").length>=2?(c.css({width:0,height:0,overflow:"hidden"}),status=!1):c.css({width:"",height:"",overflow:""})},addPhotoUpload:function(){var a=this,b=a;$("#module-10").append(c.join("")),a.$idCardFileIDList=$("[name='idCardFileIDList']"),this.eventBindBtn(function(b){a.photoUploadCallBack(b)}),$("#module-10").on("click","span[delId]",function(){var a=$(this),c=a.attr("delId"),d=$("[name='idCardFileIDList']").val();b.confirm(b.TEXT_DEL,function(){a.parent().remove();var e=d.split(",")||[],f=[];$.each(e,function(a,b){c!==b&&f.push(b)}),d=f.join(","),$("[name='idCardFileIDList']").val(d),b.setIDCardUploadStatus()})})},photoUploadCallBack:function(a){var b=this;$("#thumbPhoto img[defaultImg]").length&&$("#thumbPhoto").html(""),$("#thumbPhoto").append("<div class='fl pic-placeholder p5 bgfb mr10'><span class='iconfont delete-icon fb' title='删除' delId='"+a.result[0].fileId+"'>&#xe70a;</span><img src='"+a.result[0].fileUrl+'\' width="150" height="150"/></div>'),b.$idCardFileIDList.val((b.$idCardFileIDList.val()?b.$idCardFileIDList.val()+",":"")+a.result[0].fileId),b.setIDCardUploadStatus()}},b});