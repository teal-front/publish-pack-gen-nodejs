/**
 ** 
 ** www.huize.com; 
 ** Version:0.1.0;
 ** Last Updated:2016-08-09; 
 **
 **/
define(["jquery"],function($){"use strict";var InsureFill=function(){};return InsureFill.prototype={fillData:function(){var _this=this,_insurants=_this.insurance.insuredPersonInfoList||[],_insureType,_insurePanels,_benefiaryList,_firstBenefiary,_secondBenefiary,_dynamicModules=_this.insurance.dynamicModuleInfoList||[],_genes=_this.insurance.genes,_insurantIndex=0;if(!_this.insurance.aftertEdit&&0===_insurants.length)return!1;if(_this.setKeyValue(_this.insurance.applicantPersonInfo,$("#module-10")),_insureType=$("#module-20 *[data-insuranttype]:visible").attr("data-insuranttype"),_insurants[0]&&_insurants[0].relationInsureInsurant){var _relationType=_insurants[0].relationInsureInsurant,_item;_relationType=_this.getTransfromRelations(~~_relationType,~~_insurants[0].sex),_this.dropdownSelectItem($("#forrelationtype"),_relationType),1===_relationType&&_this.dropdownSelectItem($("#forrelationtype")[0],1)}if("more"===_insureType)_insurePanels=$("#addMoreBox > div > div:visible"),$.each(_insurants,function(index,item){index<_insurePanels.length?_this.setKeyValue(item,$(_insurePanels[index])):(_this.addTable(),_insurePanels=$("#addMoreBox > div > div"),_this.setKeyValue(item,_insurePanels[index])),_benefiaryList=eval(item.beneficiaryList),_this.fillBenefiaryList(_benefiaryList,$(_insurePanels[index]),$(_insurePanels[index]).data("index"))});else if("others"===_insureType||"myself"===_insureType){if(_this.setKeyValue(_insurants[0]||{},$("#module-20 *[data-insuranttype]:visible > div")),_insurants[0]&&_insurants[0].beneficiaryList){_benefiaryList=eval(_insurants[0].beneficiaryList);var context=$("#module-20 *[data-insuranttype]:visible")[0];_this.fillBenefiaryList(_benefiaryList,context,$(context).data("index"))}}else if("team"===_insureType){var _teams=[];$.each(_insurants,function(a){var b=this.relationInsureInsurant;b=_this.getTransfromRelations(~~b,~~this.sex),_teams.push({birthdate:this.birthdate,eName:this.eName,idNumber:this.cardNumber,idType:this.cardTypeId,name:this.cName,moblie:this.moblie,sex:"1"===this.sex?"男":"女",rType:b})}),_teams.length&&(_this.deleteTeamItemActually(_this.teamBody.find(".list-table-row")),_this.renderTeam({result:{type:_this.teamTemplateType,teamPersonInfoList:_teams}},!0),_this.teamNum+=_teams.length),_this.setCloseStatus()}$.each(_dynamicModules,function(){var a=$("#module-"+this.moduleId);0===this.moduleId&&(a=_this.el),_this.setKeyValue(this.data,a)}),_this.insurance.insuranceDateInfo&&_this.insurance.insuranceDateInfo.insuranceDate&&$("*[name='insuranceDate'][data-moduleid]").val(_this.insurance.insuranceDateInfo.insuranceDate),_this.insurance.agree&&_this.checkboxSelectItem($("#clauseInfo"));var $insure=$("[data-moduleid="+_this.MODULES_ID_INSURE_DATE+"][data-attributeid="+_this.ATTR_ID_INSURE_DATE+"]"),insureStartDate=$insure.val(),isOk=_this.dateDifference(_this.startDate.minDate,insureStartDate)>=0&&_this.dateDifference(insureStartDate,_this.startDate.maxDate)>=0;if(isOk){_this.showInsurantDateLimit($insure);var options={};options.newDate=$insure.val(),_this.setInsuredDate(options)}else $insure.val(""),$("#insurantDate").html("");if($.each($("[data-moduleid="+_this.MODULES_ID_INSURED+"][data-attributeid="+_this.ATTR_ID_BIRTHDATE+"]"),function(a,b){$(b).val()&&$(b).trigger("blur")}),_this.insurance.idCardFileUrlList&&_this.insurance.idCardFileUrlList.length>0){var idCardFileUrlList=_this.insurance.idCardFileUrlList||[],idCardFileIDList=_this.insurance.idCardFileIDList||[],$idCardFileIDList=$("[name='idCardFileIDList']"),$thumbPhoto=$("#thumbPhoto");$("#thumbPhoto img[defaultImg]").length&&$thumbPhoto.html(""),$.each(idCardFileUrlList,function(a,b){$thumbPhoto.append("<div class='fl pic-placeholder p5 bgfb mr10'><span class='iconfont delete-icon fb' title='删除' delId='"+idCardFileIDList[a]+"'>&#xe70a;</span><img src='"+b+'\' width="150" height="150"/></div>')}),$idCardFileIDList.val(idCardFileIDList.join(",")),_this.setIDCardUploadStatus()}},fillBenefiaryList:function(a,b,c){var d=this;a.length>0&&(d.dropdownSelectItem($(".beneficiarytype-select",b),2),$.each(a,function(){d.refillBeneficiaryInfo(c,this)}))},setGenDefaultValue:function(){$.each(_genes,function(a){switch(this.key){case"buyCount":$("#module-20 [name='buyCount']").val(this.value);break;case"vesterAge":$("#module-10 [name='birthdate']").val(this.value);break;case"sex":$("#module-20 [name='sex']").val(this.value)}})},setKeyValue:function(a,b){var c,d,e,f,g=this;for(var h in a)if("cardTypeName"===h&&(a[h]=a.cardTypeId),f=a[h])if(c=$("*[name='"+h+"'][data-moduleid]",b),"jobId"===h&&(c=$("*[name='jobText'][data-moduleid]",b)),"true"===c.attr("isdropdown")||c.hasClass("hz-dropdown"))if(c.hasClass("select-area"))g.dynamicSettingArea(c[0],f);else if(c.hasClass("job-level"))g.dynamicSettingJob(c[0],f);else{if("relationInsureInsurant"===h){var i=a.relationInsureInsurant;i=g.getTransfromRelations(~~i,~~a.sex),f=i}g.dropdownSelectItem(c,f)}else if("text"===c.attr("type")||"password"===c.attr("type")){if("cardPeriod"===h){var j=b.find("[name=validityTime] "),k=f.split("|");k.length>1?(j.attr("checked",!1),j.parents(".hz-check-item").removeClass("hz-check-item-checked"),f=k[0]):g.checkboxSelectItem(j.parents(".hz-check-item"))}if(c.val(f),"password"===c.attr("type")&&$("[name=reconfim-password]").val(f),"cName"===h){var l=c.data("moduleid"),m=c.data("attributeid");l===g.MODULES_ID_INSURE&&m===g.ATTR_ID_NAME&&g.insurerName(c)}c.trigger("blur")}else if("tripDestination"===h){c.val(f);var n=f.split("、"),o='<ul class="country-select-box">';$.each(n,function(a){o+="<li>"+n[a]+'<span class="del-country" title="点击删除" data-country="48" data-value="48" data-index="2" data-sort="2"></span></li>'}),o+="</ul>",$("#selectCountries").html(o)}else"flightToCity"===h?g.fillAirProtsInfo("To",f,a.toAirportCode):"flightFromCity"===h&&g.fillAirProtsInfo("From",f,a.fromAirportCode);$(".hz-radio-item",b).each(function(){d=$(this),a.hasOwnProperty(d.attr("name").split("-")[0])&&~~d.attr("value")===~~a[d.attr("name").split("-")[0]]&&(d.click(),d.attr("checked","checked"))}),$(":checkbox",b).each(function(){e=$(this);var b=e.attr("name").split("-")[0];f=a[b],"validityTime"!==b&&a.hasOwnProperty(b)&&(f&&"false"!==f?g.checkboxSelectItem(e.parents(".hz-check-item")):(e.attr("checked",!1),e.parents(".hz-check-item").removeClass("hz-check-item-checked")))}),b.length&&b.find(".id-card-input").val()&&b.find(".id-card-input").trigger("blur")},setGenValue:function(){_this.insurance.genes}},InsureFill});