/**
 ** 
 ** www.huize.com; 
 ** Version:0.1.0;
 ** Last Updated:2016-08-09; 
 **
 **/
define(["jquery","my-calendar","layer","helper"],function($,a,b,c){"use strict";var d=function(){};return d.prototype={event:function(){var a=this;a.el.delegate(".insure-form","change",function(){a.isPriceModify&&a.isReady&&a.trialChange(),$(this).hasClass("job-level")&&a.changeJob(this)}).delegate(".insure-form","blur",function(){$(this).hasClass("id-card-input")&&(a.autoSetIdInfo(this),a.validateInsuredSameCardInfo(this))}).delegate(".insure-form","click",function(){}).delegate(".add","click",function(){var b=$(this).data("type");a.addIndex++;var c=$("#module-"+a.MODULES_ID_INSURED);"more"===b&&(c.find(".form-more").length<a.maxPeople?a.addTable():a.layer({content:a.TEXT_INSURE_MAX+a.maxPeople+a.TEXT_PEOPLE}))}).delegate(".del","click",function(){var b=$(this).data("type"),c=this;"team"===b||("more"===b?a.confirm(a.TEXT_DEL,function(){a.removeMoreTable(c)}):"beneficiary"===b&&a.confirm(a.TEXT_DEL,function(){a.delBeneficiary(c)}))}).delegate(".edit","click",function(){var b=$(this).data("type"),c=this;"beneficiary"===b&&(a.editBeneficiary(c),$.placeholder.resetStatus())}).delegate(".hz-dropdown","click",function(b){if(!$(this).attr("isDropDown")){$(this).dropDown({type:1,event:function(a){return!$(a.target).hasClass("iconfont")&&!$(a.target).hasClass("more-tag")},select:function(b){return a.dropDwonSelectChange(this,b.target)}});var c=b.target;b.target&&c.click()}}).delegate(".add-beneficiary","click",function(){a.addBenficiary(this),a.setGeneralRestrictsItem()}).delegate("#insureDeclare","click",function(){a.showDeclare()}).delegate(".urgency-toggle","click",function(){a.urgencyToggle()}).delegate(".hz-radio-item","click",function(){$(this).data("lock")||($(this).myForm({checkedClass:"hz-radio-item-checked",checked:function(b,c){a.radioChecked(this,b)}}),$(this).click())}),a.eventRestrict(),a.eventCheckbox(),a.eventRadio(),1===a.product.isForcePay&&$("#noForcePay").click();var b=a.el.find('.insure-form[data-attributeid="'+a.ATTR_ID_BANK_NAME_1+'"]');b.attr("disabled",!0),a.fixedInfo(b,b.data("defaultremind"));var c=a.el.find('.insure-form[data-attributeid="'+a.ATTR_ID_BANK_NAME_2+'"]');c.attr("disabled",!0)},closeCalendar:function(){try{a.closeAll()}catch(b){}},eventCheckbox:function(a){var b=this,c=a||b.el;c.find(".hz-check-item").myForm({checked:function(a,c){b.checkboxChecked(this,a)}})},checkboxChecked:function(a,b){var c,d,e=this,f=$(a),g=f.find("[type=checkbox]");if(g.attr("checked",b),"clauseInfo"===f.attr("id"))d=$(".clause-insure-tips"),b?d.text(""):d.text($("#clauseInfo").data("errorremind")||"");else if(f.hasClass("credentials-validity"))b?f.parents(".credentials-form").find(".validity-end-item").hide().parents(".placeholder-wrap").hide():f.parents(".credentials-form").find(".validity-end-item").show().parents(".placeholder-wrap").show();else{if(d=f.find(".write-info-error"),c=e.toInt(f.data("required")),!c)return;b?d.text(""):d.text(f.data("errorremind")||"")}},checkboxSelectItem:function(a){var b=this,c=$(a);c.hasClass("hz-check-item-checked")?b.checkboxChecked(a,!0):c.click()},eventRadio:function(a){var b=this,c=a||b.el;c.find(".hz-radio-item").myForm({checkedClass:"hz-radio-item-checked",checked:function(a,c){b.radioChecked(this,a)}})},radioChecked:function(a,b){var c=this,d=$(a),e=d.attr("name"),f=d.attr("value");$("[name="+e+"]").each(function(){if($(this).attr("value")===f){if($(this).attr("checked",b),$(this).hasClass("forcepay")){var a=$("#forcePayContent");"0"===f?a.hide():a.show()}}else $(this).removeClass("hz-radio-item-checked"),$(this).attr("checked",!1)}),d.attr("trial")&&c.trialChange(d)},eventValidate:function(){var a=this;this.el.on("click",".insure-team-input",function(){$(this).parents(".list-table-row").find(".insure-tips").html("")}).on("blur",".form-item",function(){var b,c=this;if(a.hideDefault(this),!$(this).hasClass("hz-dropdown"))if($(this).hasClass("insure-team-input")){var d=$(this).parents(".list-table-row"),e=d.find(".write-info-error"),f=$(this).data("errorremind")||"";b=a.validate(this,function(){e.html(""),a.hideError(c),a.showSuccess(c)},function(){e.html(f),a.hideSuccess(c),a.showError(c)})}else if(b=a.validate(this)){var g=$(this).data("attributeid"),h=$(this).data("moduleid");h===a.MODULES_ID_INSURE&&g===a.ATTR_ID_NAME&&a.insurerName(this)}}).on("focus",".form-item",function(){a.hideSuccess(this),a.hideError(this),a.showDefault(this)}).on("blur",".validate-restricts-value",function(){var b,c=$(this).data("restrictId"),d=$(this).val(),e="";if(a.validate(this)){switch(b=a.restrictId[c],a.info(b),b.conditions){case 0:e="大于";break;case 1:e="必须大于等于";break;case 2:e="大于";break;case 3:e="小于等于"}a.restrictCale(d,a.getConditions[b.conditions],b.value)?a.restrictStatus[c]={status:!0,errorText:e,element:this}:(e+=b.value+a.getUnit(b.unit),a.showError(this,e),a.restrictStatus[c]={status:!1,errorText:e,element:this})}})},eventDrowDown:function(a){var b=this,c=a?$(a):b.el;c.find(".hz-dropdown").dropDown({type:1,width:"auto",time:50,event:function(a){return!$(a.target).hasClass("iconfont")&&!$(a.target).hasClass("more-tag")},select:function(a){return b.dropDwonSelectChange(this,a.target)}})},dropDwonSelectChange:function(a,b){var c=this,d=$(b),e=$('.hz-dropdown[data-dropdown="'+d.parents(".hz-dropdown-content").data("dropdown-item")+'"]'),f=e.find(".input-select-text"),g=!1,h="",i=c.toInt($(a).data("attributeid")),j="";if(!d.hasClass("hz-select-option"))return!1;if(h=d.text(),c.oldValue=c.toInt($(a).val()),f.is(":text")?f.val(h):f.text(h),j=void 0===d.data("value")?void 0===d.attr("value")?d.attr("text"):d.attr("value"):d.data("value"),e.find(".hz-select-option-selected").removeClass("hz-select-option-selected"),$("#dropDownSelectArea").find(".hz-select-option-selected").removeClass("hz-select-option-selected"),d.addClass("hz-select-option-selected"),$(a).data("value",j).attr("value",j).blur(),"body"===e.data("show")&&e.find("[data-value="+j+"]").addClass("hz-select-option-selected"),e.hasClass("for-relation-select")){d.data("forrelationtype");c.forrelationChange(a)}if(e.hasClass("beneficiarytype-select")){var k=d.data("beneficiarytype"),l=e.data("insurantindex");1===k?$(".zd-beneficiary[data-insurantindex="+l+"]").hide():$(".zd-beneficiary[data-insurantindex="+l+"]").show()}if(e.data("attributeid")===c.ATTR_ID_RELATIONINSUREINSURANT&&c.relationChange(a),$(a).attr("executes")&&c.restrictRun(a),$(a).hasClass("select-area")&&c.changeArea(a),g=!0,$(a).data("text",f.text()),"team"===$(a).data("type")&&($(a).data("value",d.data("value")),c.setTeamItemInfo(a)),i===c.ATTR_ID_CREDENTIALSTYPE){c.eventIDCard(a);var m=$(a).parents(".credentials-form"),n=c.replaceNull(c.data.cardNumRegexJson[d.val()||d.data("value")]),f=$(a).parents("li.list-table-row").find(".insure-code"),o=$(a).parents(".list-table-row"),p=o.find(".write-info-error"),q=f.data("errorremind")||"";m.find('input.insure-form[data-attributeid="'+c.ATTR_ID_CREDENTIALSINPUT+'"]').data("regex",n),c.validate(f,function(){p.html(""),c.hideError(f),c.showSuccess(f)},function(){p.html(q),c.hideSuccess(f),c.showError(f)})}$(a).change(),c.validate(a),$("#beneficiary-dialog").find("input:visible").placeholder({});try{$.placeholder.resetStatus()}catch(r){}return g},dropdownSelectItem:function(a,b){var c=this,d=$(a),e=d.find('.hz-select-option[data-value="'+b+'"]').length>0?d.find('.hz-select-option[data-value="'+b+'"]'):d.find('.hz-select-option[value="'+b+'"]');e.length>0&&(c.setDropdownSelectValue(a,b),c.dropDwonSelectChange(a,e))},setDropdownSelectValue:function(a,b){var c=$(a),d=c.find(".input-select-text"),e=c.find('.hz-select-option[data-value="'+b+'"]').length>0?c.find('.hz-select-option[data-value="'+b+'"]'):c.find('.hz-select-option[value="'+b+'"]');if(e){var f=e.text();c.find(".hz-select-option-selected").removeClass("hz-select-option-selected"),e.addClass("hz-select-option-selected"),c.data("value",e.attr("value")||e.attr("text")).attr("value",e.attr("value")||e.attr("text")),d.is(":text")?d.val(f):d.text(f)}},dropdownSelectItemClear:function(a){var b=this,c=$(a),d=c.find(".input-select-text"),e=c.find(".hz-select-option:eq(0)"),f=void 0===e.data("value")?void 0===e.attr("value")?e.attr("text"):e.attr("value"):e.data("value"),g=e.attr("data-attributeid");g===b.ATTR_ID_CREDENTIALSTYPE||c.hasClass("beneficiarytype-select")?b.dropdownSelectItem(a,f):(c.data("value","").attr("value",""),d.text("请选择"),c.find(".hz-select-option-selected").removeClass("hz-select-option-selected"))},eventIDCard:function(a){var b=this,c=$(a),d=c.data("moduleid"),e=c.parents(".credentials-form"),f=c.data("attributeid"),g=e.find("[data-moduleid="+d+"][data-attributeid="+b.ATTR_ID_SEX+"]").parents(".field-row"),h=e.find("[data-moduleid="+d+"][data-attributeid="+this.ATTR_ID_BIRTHDATE+"]").parents(".field-row"),i=e.find("[data-moduleid="+d+"][data-attributeid="+this.ATTR_ID_CREDENTIALSINPUT+"]");b.ATTR_ID_CREDENTIALSTYPE===f&&(1===c.data("value")?(g.hide(),h.hide()):(g.show(),h.show()),i.val()&&i.trigger("blur"))},eventSubmit:function(){var a=this;a.submitStatus=!0,a.el.on("click",".submit-button",function(){return a.submitStatus=a.validateAll(),a.submitStatus&&(a.validateTeam()||(a.submitStatus=!1,a.logRed("团单校验没通过"))),a.submitStatus&&a.isTeamInsurant&&a.teamNum<a.minPeople&&(a.showTeamError({type:"min"}),a.submitStatus=!1,a.logRed("团单最小人数校验没通过")),a.submitStatus&&!a.validateInsureDate()&&(a.submitStatus=!1,a.logRed("日期范围校验没通过")),a.submitStatus&&a.validateDuplicate().number?(a.logRed("团单重复项验证没通过"),void(a.submitStatus=!1)):(a.submitStatus&&!a.isTeamInsurant&&(a.validateInsureAge()||(a.submitStatus=!1)),a.submitStatus&&!a.isTeamInsurant&&(a.validateInsurantNum()||(a.submitStatus=!1)),a.submitStatus&&1===a.toInt(a.data.product.isInsurantAdult)&&(a.validateInsurantAdult()||(a.submitStatus=!1)),a.submitStatus&&1===a.toInt(a.data.product.isInsurantJuveniles)&&!a.isSelf&&(a.validateInsurantJuveniles()||(a.submitStatus=!1)),a.submitStatus&&!a.validateBeneficiary()&&(a.submitStatus=!1),a.submitStatus&&!a.validateDestination()&&(a.submitStatus=!1),a.validateHighPremium()?$("#clauseInfo").hasClass("hz-check-item-checked")?void(a.getREstrictStatus()&&a.submitStatus&&a.checkLogin(a.submit)):(a.logRed("请选择同意条款"),$(".clause-insure-tips").text($("#clauseInfo").data("errorremind")||""),void(a.submitStatus=!1)):void(a.submitStatus=!1))}).on("click","#saveInsureToCar",function(){a.saveShopCar=!0,a.submitStatus=a.validateAll(null,null,!0),a.validateInsureDate()||(a.submitStatus=!1),a.submitStatus&&(a.validateTeam()||(a.submitStatus=!1,a.logRed("团单校验没通过"))),a.submitStatus&&a.isTeamInsurant&&a.teamNum<a.minPeople&&(a.submitStatus=!1,a.logRed("团单最小人数校验没通过")),a.submitStatus&&!a.validateInsureDate()&&(a.submitStatus=!1,a.logRed("日期范围校验没通过")),a.submitStatus&&a.validateDuplicate().number&&(a.logRed("团单重复项验证没通过"),a.submitStatus=!1),a.submitStatus&&!a.validateBeneficiary()&&(a.submitStatus=!1),a.submitStatus&&!a.validateDestination()&&(a.submitStatus=!1),$("#clauseInfo").hasClass("hz-check-item-checked")||(a.submitStatus=!1),a.saveShopCar=!1,a.checkLogin(a.saveToShopCar)})},getFirstJob:function(a,b){var c=this,d=a||c.el,e=c.firstJobDataOptions,f=b||function(){},g=d.find('.job-level[data-attributeid="'+c.ATTR_ID_JOB+'"]');$.each(g,function(a,b){$(this).find(".hz-select-option").length<=1&&c.resetSelect(g,e)}),f.call(this)},getJobData:function(a){var b=this,c=a||{},d={productId:b.baseProductId,companyJobParentId:c.companyJobParentId||0};b.jsonp(b.getJobUrl,d,function(a){var b=[],d=a.data||[];$.each(d,function(a,c){b.push('<li class="hz-select-option"   value="'+c.id+'" id="'+c.id+'" code="'+c.code+'" text="'+c.name+'" level="'+c.level+'">'+c.name+"</li>")}),c.callback&&c.callback(b,a)})},jobTips:function(a){var b=this;layer.closeAll(),layer.open({skin:"huize-layer",type:1,title:b.TEXT_DIALOG_TITLE_DEFAULT,shift:2,btn:["确定"],area:["350px"],yes:function(b){layer.close(b),a&&a()},cancel:function(){a&&a()},shadeClose:!0,content:'<div style="padding:20px;">'+this.TEXT_JOBTIPS+"</div>"})},changeJob:function(a,b){function c(){p.val(""),q.val(""),r.val(""),s.val("")}var d,e,f,g,h=this,i=$(a),j=i.val(),k=h.toInt(i.attr("job")),l=(i.nextAll('[job="'+k+'"]'),i.parent().find('[job="1"]')),m=i.parent().find('[job="2"]'),n=i.parent().find('[job="3"]'),o=i.find(".hz-select-option.hz-select-option-selected"),p=i.nextAll('input[name="jobText"]'),q=i.nextAll('input[name="jobId"]'),r=i.nextAll('input[name="jobNum"]'),s=i.nextAll('input[name="jobLevel"]'),t=b||function(){};c(),i.data("jobText",o.attr("text")),i.data("jobId",o.attr("id")),i.data("jobNum",o.attr("code")),i.data("jobLevel",o.attr("level")),1===k?(h.resetSelect(m),h.resetSelect(n),m.hide(),n.hide()):2===k&&(h.resetSelect(n),n.hide()),j&&"请选择"!==j&&h.getJobData({companyJobParentId:j,callback:function(a){1===k?(h.resetSelect(m,a),t(),m.show().data("required",1)):2===k?a.length?(h.resetSelect(n,a),n.show().data("required",1),t()):(n.hide(),d=l.data("jobText")+"-"+m.data("jobText"),e=l.data("jobId")+"-"+m.data("jobId"),f=(l.data("jobNum")?l.data("jobNum")+"-":"")+(m.data("jobNum")?m.data("jobNum"):""),g=l.data("jobLevel")||m.data("jobLevel")||n.data("jobLevel"),p.val(d),q.val(e),r.val(f),s.val(g),-1===h.data.product.jobGrade.indexOf(g)&&h.jobTips(function(){m.hide(),n.hide(),l.val(""),m.val(""),n.val(""),h.validate(l),h.resetSelect(m),h.resetSelect(n),c()})):3===k&&(t(),d=l.data("jobText")+"-"+m.data("jobText")+"-"+n.data("jobText"),e=l.data("jobId")+"-"+m.data("jobId")+"-"+n.data("jobId"),f=(l.data("jobNum")?l.data("jobNum")+"-":"")+(m.data("jobNum")?m.data("jobNum")+"-":"")+n.data("jobNum"),g=l.data("jobLevel")||m.data("jobLevel")||n.data("jobLevel"),p.val(d),q.val(e),r.val(f),s.val(g),-1===h.data.product.jobGrade.indexOf(g)&&h.jobTips(function(){m.hide(),n.hide(),l.val(""),m.val(""),n.val(""),h.validate(l),h.resetSelect(m),h.resetSelect(n),c()}))}})},dynamicSettingJob:function(a,b){var c=this,d=$(a),e=d.nextAll(".hz-dropdown").eq(0),f=d.nextAll(".hz-dropdown").eq(1),g=d.parents(".credentials-form"),h=b||"",i=h.split("-");return d.val(""),e.val("").hide(),f.val("").hide(),i.length&&d.length?d.find(".hz-select-option").length<=1?void c.getFirstJob(g,function(){c.dynamicSettingJob(a,provCityId)}):void(d.find('.hz-select-option[value="'+i[0]+'"]').length&&(c.setDropdownSelectValue(d,i[0]),c.changeJob(d,function(){return e.find('.hz-select-option[value="'+i[1]+'"]').length?(c.setDropdownSelectValue(e,i[1]),2>=i?void f.hide():void c.changeJob(e,function(){f.find('.hz-select-option[value="'+i[2]+'"]').length&&(c.setDropdownSelectValue(f,i[2]),c.changeJob(f))})):void 0}))):void 0},setJuvenilesJob:function(a){var b,c=this,d=$(a),e=d.val(),f=d.parents(".credentials-form"),g=f.find("[data-attributeid="+c.ATTR_ID_JOB+"]").eq(0),h=c.product.juvenilesJobFullId;b=c.getFullAge({select:e}),h&&18>b?(g.parents(".field-row").hide(),c.dynamicSettingJob(g,h)):g.parents(".field-row").show()},addTable:function(){var a,b,c=this;$.each(this.data.modules,function(a,b){20===b.id&&(c.addMoreBox.append(c.addMoreTable(b)),c.setAreaData())}),this.setTableIndex(),this.setDeleteStatus(c.addMoreBox,c.TEXT_DELETED_TYPE_INSURANT),a=c.addMoreBox.find(".credentials-form.insurant-item-form"),b=a.length,c.initCalendar(a.eq(b-1)),c.eventCheckbox(a.eq(b-1)),c.eventRadio(a.eq(b-1)),c.getFirstInsureArea(a.eq(b-1)),c.getAllArea(a.eq(b-1)),c.getFirstJob(a.eq(b-1)),c.defaultRestrict(a.eq(b-1)),c.setGeneralRestrictsItem(),c.setTrialItem(a.eq(b-1)),c.initBeneficiaryType(a.eq(b-1)),c.defaultSelectIdCard(a.eq(b-1)),$.each(a.eq(b-1).find("[data-moduleid="+c.MODULES_ID_INSURED+"][data-attributeid="+c.ATTR_ID_BIRTHDATE+"]"),function(a,b){$(b).val()&&$(b).trigger("blur")})},formIndex:0,addMoreTable:function(a){var b=this,c=[];return b.formIndex++,b.insurantIndex++,c.push('<div class="person-write-info more-insure"  sort="'+b.formIndex+'">'),c.push('<div class="form-more credentials-form insurant-item-form" data-type="more" data-index="'+b.formIndex+'">'),c.push('<div class="info-title"><a href="javascript:;" title="删除" data-type="more" class="fr iconfont  del delete">&#xe70a;</a>第<span class="table-index"></span>名被保人</div>'),c.push(b.renderTable(a,!1)),c.push(b.renderBeneficiaryModule(b.insurantIndex)),c.push('<div class="saveContract mb10"><label class="label-item vis-hide">保存为常用联系人</label>'),c.push('<div class="hz-check-item hz-check-item-checked inline-block"  rel="checkbox"> <i class="hz-check-icon"></i>'),c.push('<input class="insure-checkbox fn-hide" type="checkbox" name="chkSaveInsure" id="chkSaveInsure-'+a.id+"-"+b.formIndex+'"  data-moduleid="'+a.id+'" class="insure-label" value="1" checked />'),c.push('<label class="hz-check-text f12 fc6 ml5" for="chkSaveInsure-'+a.id+"-"+b.formIndex+'">保存为常用联系人</label>'),c.push("</div>"),c.push("</div>"),c.push("</div>"),c.push("</div>"),c.join("")},setTableIndex:function(){this.el.find(".table-index").each(function(a,b){$(this).text(a+1)})},setDeleteStatus:function(a,b){var c=a.find(".del[data-type="+b+"]"),d=c.length;1===d?c.hide():c.show()},removeMoreTable:function(a){$(a).parents(".more-insure").remove(),this.setTableIndex(),this.setDeleteStatus(this.addMoreBox,this.TEXT_DELETED_TYPE_INSURANT),this.trialChange()},initRelationSelect:function(){var a=this,b=[],c=a.insurantTypeArr,d=a.defaultInsureInsurantRelation,e=[];d||"1"===c[0]?("1"!==c[2]&&"1"!==c[3]&&"1"===c[1]?(e=a.tranfromRelations(d),e.forEach(function(a,c){b.push('<li class="hz-select-option"  value="'+a.controlValue+'" text="'+a.value+'"> '+a.value+"</li>")}),$("#module-20").find('[data-insuranttype="myself"]').hide()):"1"===c[0]&&"1"!==c[1]&&"1"!==c[2]&&"1"!==c[3]&&(b.push('<li class="hz-select-option" value='+a.SELFRELATIONTYPE+' text="本人">本人</li>'),$("#module-10 .saveContract").hide()),$("#forrelationtype .hz-dropdown-menu").append(b.join(""))):($("#forrelationtype").parents(".field-item").addClass("fn-hide"),$("#module-20").find('[data-insuranttype="myself"]').hide())},tranfromRelations:function(a){var b=this,c=[];a.forEach(function(a,d){var e=!1;b.RELATIONMAP.forEach(function(b,d){a.controlValue===b.defaultValue&&(c=c.concat(b.transRelation),e=!0)}),e||c.push(a)});var d=[];return c.forEach(function(a,b){for(var c=!1,e=0;e<d.length;e++)if(d[e].controlValue===a.controlValue){c=!0;break}c||d.push(a)}),c=d},getTransfromRelations:function(a,b){var c=this,d=a;return c.RELATIONMAP.forEach(function(c,e){a===c.defaultValue&&(d=c.transRelation.length>1&&!b?c.transRelation[1].controlValue:c.transRelation[0].controlValue)}),d},relationChange:function(a){var b=this;$(a);b.syncInsureInfo(a)},syncInsureInfo:function(a){var b=this,c=$(a),d=b.toInt(c.val()),e=c.parents(".insurant-item-form"),f=[],g=[],h=[],i=[],j=b.insureModules.find(".insure-form:visible"),k=j.length;j.each(function(a){var c,j=$(this).attr("name")||"",l=$(this).val()||$(this).attr("value"),m=j.replace(b.regReplaceNum,""),n=b.toInt($(this).data("attributeid"));-1!==m.indexOf("job")&&f.push(l),n===b.ATTR_ID_AREA_LIVING&&g.push(l),n===b.ATTR_ID_AREA_PROPERTY&&h.push(l),d===b.SELFRELATIONTYPE&&($(this).hasClass("hz-radio-item")?$(this).hasClass("hz-radio-item-checked")&&(m=m.split("-")[0],c=e.find('[name^="'+m+'"][value="'+l+'"]'),c.click()):$(this).hasClass("hz-dropdown")?b.dropdownSelectItem(e.find('[name^="'+m+'"][data-moduleid=20]:visible'),l):(c=e.find('[name^="'+m+'"][data-moduleid=20]:visible'),-1!==m.indexOf("UserInfo")&&(c=e.find('[name^="UserInfo"]:visible')),c.val(l)),"cardPeriod"===m&&l&&i.push(l),"cardPeriodEnd"===m&&l&&i.push(l),a===k-1&&(b.dynamicSettingArea(e.find('.select-area[data-attributeid="'+b.ATTR_ID_AREA_LIVING+'"]').eq(0),g.join("-")),b.dynamicSettingArea(e.find('.select-area[data-attributeid="'+b.ATTR_ID_AREA_PROPERTY+'"]').eq(0),h.join("-")),b.dynamicSettingJob(e.find(".job-level").eq(0),f.join("-")),b.setCardInfo(e,i))),b.validate(c)}),b.autoSetIdInfo(e.find(".id-card-input")),b.validateInsuredSameCardInfo(e.find(".id-card-input"))},setCardInfo:function(a,b){var c=b||[],d=a.find(".credentials-validity"),e=a.find(".insure-calendar[name*=cardPeriod]"),f=a.find(".insure-calendar[name*=cardPeriodEnd]");0===c.length?(d.attr("checked",!1),e.val("").show(),f.val("").show()):1===c.length?(d.attr("checked",!0),e.val(c[0]).show(),f.val("").hide()):2===c.length&&(d.attr("checked",!1),e.val(c[0]).show(),f.val(c[1]).show()),d.change(),this.validate(e),this.validate(f)},isSelf:!1,forrelationChange:function(a){var b=this,c=$(a),d=b.toInt(c.val()),e=$("#module-10  [data-attributeid="+b.ATTR_ID_CREDENTIALSINPUT+"]"),f=$("#module-10 [data-attributeid="+b.ATTR_ID_BIRTHDATE+"]");d===b.SELFRELATIONTYPE?($('#module-20  [data-insuranttype="myself"]').show(),$('#module-20  [data-insuranttype="others"]').hide(),$("#module-10 .saveContract").hide(),b.isSelf=!0,b.selfDefaultRestrict(),b.validateInsureAge(),b.trialChange(),$("#module-10 .info-title").html("您的信息"),$("#module-10.person-write-info").addClass("pb0"),$("#module-20 .person-write-info").addClass("pt0"),e.val()&&e.trigger("blur"),f.val()&&f.trigger("blur")):($('#module-20  [data-insuranttype="myself"]').hide(),$('#module-20  [data-insuranttype="others"]').show(),$("#module-10 .saveContract").show(),b.isSelf=!1,b.restSelfDefaultRestrict(),b.validateInsureAge(),b.trialChange(),$("#module-10 .info-title").html("投保人信息"),$("#module-10.person-write-info").removeClass("pb0"),$("#module-20 .person-write-info").removeClass("pt0"),e.val()&&e.trigger("blur"),f.val()&&f.trigger("blur"))},defaultSelectSelf:function(){var a=this,b=(a.insurantTypeArr,$("#forrelationtype"));b.find(".hz-select-option[value="+a.SELFRELATIONTYPE+"]").length>0&&(a.dropdownSelectItem(b,a.SELFRELATIONTYPE),$.each(a.ruleParam.genes,function(b,c){if(c.key)switch(c.key){case a.SEXKEY:var d=$("[data-moduleid=10][data-attributeid="+a.ATTR_ID_SEX+"]");$.each(d,function(){c.value.indexOf($(this).find(".hz-radio-text").text())>-1&&$(this).click()});break;case a.INSURANTDATEKEY:c.value.split("-").length>2&&$("[data-moduleid=10][data-attributeid="+a.ATTR_ID_BIRTHDATE+"]").val(c.value)}}),a.trialChange())},getFixedDateValue:function(){var a=$(".fixed-date").val();return a||(a=this.startDate.minDate),a},setStartDate:function(a){var b=this,c=0;b.jsonp(b.getInsureTimeUrl,{baseProductId:b.baseProductId},function(a){c=a.result},!1),b.startDate={maxDate:b.createDate({date:b.product.latestDate}),minDate:b.createDate({date:b.product.firstDate+c})},a&&a()},showDeclare:function(){var a,c=this,d=c.product.insureDeclare||c.TEXT_DEFAULT_DECLARE;d=d.replace("#ProductClauseUrl#",c.clauseUrl),a='<div class="insure-des-dialog p20 f12">'+d+"</div>",b.open({type:1,shift:2,title:"投保申明",area:["870px","450px"],shadeClose:!0,content:a})},urgencyToggle:function(){var a=this,b=a.el.find(".urgency-toggle"),c=$("#urgencyContent");b.toggleClass("urgency-show"),b.hasClass("urgency-show")?(b.find(".iconfont").html("&#xe712;"),c.show()):(b.find(".iconfont").html("&#xe711;"),c.hide())},checkLogin:function(a){var b=this;c.state.checkLogin(function(c){c.result?a.apply(b):requirejs(["sign-float"],function(c){new c({showRegister:!0,callback:function(c){layer.closeAll(),a.apply(b)}})})})}},d});